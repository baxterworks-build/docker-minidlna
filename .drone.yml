---
kind: pipeline
name: default

clone:
  disable: true

steps:
- name: clone recursive
  image: alpine/git
  commands:
  - git clone --recursive --depth=1 ${DRONE_GIT_HTTP_URL} .

- name: build
  image: alpine:latest
  commands: 
    - sh build.sh

- name: publish  
  image: plugins/github-release
  when:
    ref:
      include: 
        - refs/tags/release-*
  settings:
    api_key:
      from_secret: github_token
    files:
      - /output/*.tar.gz
    when:
      event: tag
